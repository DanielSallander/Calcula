We need to optimize the "Clear Contents" command.
It seems to be a huge lag when using this command on an entire row or column.
For example, I write the values 5 in cell B5. I then right click the 5 and take clear contents.
Only after a while the content is cleared.
If I write something in another cell, for example B6, it appears only after a while (which suggest async await).
So we should definetly look for a way to optimize the clear contents operation.
Is it iterating through every cell, even outside the used range?

Here are the console messages:
Layout.tsx:16 [Layout] Rendering
gridExtensions.ts:157 [GridExtensions] Registered context menu item: core:cut
gridExtensions.ts:157 [GridExtensions] Registered context menu item: core:copy
gridExtensions.ts:157 [GridExtensions] Registered context menu item: core:paste
gridExtensions.ts:157 [GridExtensions] Registered context menu item: core:clearContents
gridExtensions.ts:157 [GridExtensions] Registered context menu item: core:insertRow
gridExtensions.ts:157 [GridExtensions] Registered context menu item: core:insertColumn
gridExtensions.ts:157 [GridExtensions] Registered context menu item: core:devTools
sheetExtensions.ts:88 [SheetExtensions] Registered context menu item: core:rename
sheetExtensions.ts:88 [SheetExtensions] Registered context menu item: core:delete
sheetExtensions.ts:88 [SheetExtensions] Registered context menu item: core:insertSheet
2useSpreadsheetStyles.ts:50 [Styles] Loaded 1 styles from backend
InlineEditor.tsx:361 [InlineEditor] Focused input, cursor at position: 1
useEditing.ts:590 [useEditing] commitEdit called Object
InlineEditor.tsx:306 [InlineEditor] Blur committing, value: 5
useEditing.ts:577 [useEditing] commitEdit skipped - already in progress
tauri-api.ts:61 [tauri-api] updateCell(2, 2, "5")
tauri-api.ts:64 [tauri-api] updateCell returned 1 updated cells
GridCanvas.tsx:277 [Cells] Fetched 1 cells. First cell: row=2, col=2, display="5", style_index=0
InlineEditor.tsx:361 [InlineEditor] Focused input, cursor at position: 1
useEditing.ts:590 [useEditing] commitEdit called Object
InlineEditor.tsx:306 [InlineEditor] Blur committing, value: 6
useEditing.ts:577 [useEditing] commitEdit skipped - already in progress
tauri-api.ts:61 [tauri-api] updateCell(2, 3, "6")
tauri-api.ts:64 [tauri-api] updateCell returned 1 updated cells
GridCanvas.tsx:277 [Cells] Fetched 2 cells. First cell: row=2, col=2, display="5", style_index=0
InlineEditor.tsx:361 [InlineEditor] Focused input, cursor at position: 1
useEditing.ts:590 [useEditing] commitEdit called Object
InlineEditor.tsx:306 [InlineEditor] Blur committing, value: 7
useEditing.ts:577 [useEditing] commitEdit skipped - already in progress
tauri-api.ts:61 [tauri-api] updateCell(2, 4, "7")
tauri-api.ts:64 [tauri-api] updateCell returned 1 updated cells
GridCanvas.tsx:277 [Cells] Fetched 3 cells. First cell: row=2, col=2, display="5", style_index=0
Spreadsheet.tsx:109 [Spreadsheet] Clearing contents from (2,0) to (2,16383)
InlineEditor.tsx:361 [InlineEditor] Focused input, cursor at position: 1
useEditing.ts:590 [useEditing] commitEdit called Object
InlineEditor.tsx:306 [InlineEditor] Blur committing, value: 7
useEditing.ts:577 [useEditing] commitEdit skipped - already in progress
tauri-api.ts:61 [tauri-api] updateCell(3, 3, "7")
tauri-api.ts:64 [tauri-api] updateCell returned 1 updated cells
InlineEditor.tsx:361 [InlineEditor] Focused input, cursor at position: 1
useEditing.ts:590 [useEditing] commitEdit called Object
InlineEditor.tsx:306 [InlineEditor] Blur committing, value: 8
useEditing.ts:577 [useEditing] commitEdit skipped - already in progress
tauri-api.ts:61 [tauri-api] updateCell(3, 4, "8")
tauri-api.ts:64 [tauri-api] updateCell returned 1 updated cells
InlineEditor.tsx:361 [InlineEditor] Focused input, cursor at position: 1
useEditing.ts:590 [useEditing] commitEdit called Object
tauri-api.ts:61 [tauri-api] updateCell(3, 2, "4")
tauri-api.ts:64 [tauri-api] updateCell returned 1 updated cells
useViewport.ts:315 [VIEWPORT] scrollToSelection called: Object
useViewport.ts:300 [VIEWPORT] scrollToCell called: Object
InlineEditor.tsx:361 [InlineEditor] Focused input, cursor at position: 1
useEditing.ts:590 [useEditing] commitEdit called Object
tauri-api.ts:61 [tauri-api] updateCell(4, 3, "6")
tauri-api.ts:64 [tauri-api] updateCell returned 1 updated cells
useViewport.ts:315 [VIEWPORT] scrollToSelection called: Object
useViewport.ts:300 [VIEWPORT] scrollToCell called: Object
Spreadsheet.tsx:124 [Spreadsheet] Clear contents complete
GridCanvas.tsx:277 [Cells] Fetched 4 cells. First cell: row=3, col=2, display="4", style_index=0
Spreadsheet.tsx:109 [Spreadsheet] Clearing contents from (3,0) to (3,16383)
InlineEditor.tsx:361 [InlineEditor] Focused input, cursor at position: 1
useEditing.ts:590 [useEditing] commitEdit called {editingRow: 4, editingCol: 2, sourceSheetIndex: 0, sourceSheetName: 'Sheet1', currentSheetIndex: 0, …}
InlineEditor.tsx:306 [InlineEditor] Blur committing, value: 4
useEditing.ts:577 [useEditing] commitEdit skipped - already in progress
tauri-api.ts:61 [tauri-api] updateCell(4, 2, "4")
tauri-api.ts:64 [tauri-api] updateCell returned 1 updated cells
InlineEditor.tsx:361 [InlineEditor] Focused input, cursor at position: 1
useEditing.ts:590 [useEditing] commitEdit called {editingRow: 4, editingCol: 4, sourceSheetIndex: 0, sourceSheetName: 'Sheet1', currentSheetIndex: 0, …}
tauri-api.ts:61 [tauri-api] updateCell(4, 4, "8")
tauri-api.ts:64 [tauri-api] updateCell returned 1 updated cells
useViewport.ts:315 [VIEWPORT] scrollToSelection called: {endRow: 4, endCol: 4}
useViewport.ts:300 [VIEWPORT] scrollToCell called: {row: 4, col: 4, center: false}
InlineEditor.tsx:361 [InlineEditor] Focused input, cursor at position: 1
useEditing.ts:590 [useEditing] commitEdit called {editingRow: 5, editingCol: 3, sourceSheetIndex: 0, sourceSheetName: 'Sheet1', currentSheetIndex: 0, …}
tauri-api.ts:61 [tauri-api] updateCell(5, 3, "9")
tauri-api.ts:64 [tauri-api] updateCell returned 1 updated cells
useViewport.ts:315 [VIEWPORT] scrollToSelection called: {endRow: 5, endCol: 3}
useViewport.ts:300 [VIEWPORT] scrollToCell called: {row: 5, col: 3, center: false}
InlineEditor.tsx:361 [InlineEditor] Focused input, cursor at position: 1
GridCanvas.tsx:277 [Cells] Fetched 4 cells. First cell: row=4, col=2, display="4", style_index=0
useEditing.ts:590 [useEditing] commitEdit called {editingRow: 6, editingCol: 2, sourceSheetIndex: 0, sourceSheetName: 'Sheet1', currentSheetIndex: 0, …}
tauri-api.ts:61 [tauri-api] updateCell(6, 2, "3")
tauri-api.ts:64 [tauri-api] updateCell returned 1 updated cells
useViewport.ts:315 [VIEWPORT] scrollToSelection called: {endRow: 6, endCol: 2}
useViewport.ts:300 [VIEWPORT] scrollToCell called: {row: 6, col: 2, center: false}
Spreadsheet.tsx:124 [Spreadsheet] Clear contents complete
GridCanvas.tsx:277 [Cells] Fetched 5 cells. First cell: row=4, col=2, display="4", style_index=0